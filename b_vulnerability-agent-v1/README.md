# Vulnerability Agent

**Naval Electronic Warfare Attack Response System**

Multi-agent system for detecting, classifying, and responding to electronic warfare attacks on naval vessels. 
Part 2 of a 3-project naval AI series.

---

## Project Overview

Vulnerability Agent v1 responds to electronic warfare attacks through a five-phase workflow:

1. **Detection**: Network anomaly analysis (packet loss, latency, corrupted frames)
2. **Classification**: Jamming source identification by type (barrage, spot, sweep, deceptive, etc.)
3. **Planning**: Generation of three distinct countermeasure strategies
4. **Evaluation**: Simulation-based plan validation (iterative planner-evaluator loop)
5. **Execution**: Human-selected plan deployment via ship systems

### Key Features

- 5 specialized AI agents with distinct roles
- Human-in-the-loop (HITL) for final plan selection
- Iterative planner-evaluator pattern ensuring plan viability
- Jamming database with 7 attack types and recommended countermeasures
- Sensor simulation suite (ESM, ELINT, Radar, GNSS, Communications)
- Placeholder actuator tools for countermeasure execution
- Web interface (Gradio) and CLI modes


---

## Project Structure

```bash
vulnerability-agent-v1/
â”œâ”€â”€ pyproject.toml              # UV dependencies
â”œâ”€â”€ README.md
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ agents.yaml             # 5 agent definitions
â”‚   â”œâ”€â”€ tasks.yaml              # 5 task definitions
â”‚   â””â”€â”€ jamming_database.json   # Jamming types & countermeasures
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ crew.py                 # Crew definition
â”‚   â”œâ”€â”€ main.py                 # Public API + CLI + HITL
â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”œâ”€â”€ multimodal_tools.py         # Sensor simulators
â”‚   â”‚   â”œâ”€â”€ network_anomaly_detector.py
â”‚   â”‚   â”œâ”€â”€ jamming_classifier.py
â”‚   â”‚   â”œâ”€â”€ countermeasure_simulator.py
â”‚   â”‚   â””â”€â”€ actuator_tools.py           # 7 dummy actuators
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ attack_data.py      # Pydantic models
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ logger.py           # Python stdlib logging
â”œâ”€â”€ data/sample_attacks/        # 4 example scenarios
â””â”€â”€ gradio_vulnerability_v1_app.py
```

---

## Installation

```bash
# Install dependencies with UV
uv pip install -e .

# Set up environment variables (create .env file)
# ANTHROPIC_API_KEY=sk-ant-...
# or OPENAI_API_KEY=sk-...
```

---

## Usage

### CLI Mode

Run test scenario with sample attack:

```bash
uv run python -m src.main
```

The system will:
1. Analyze sample jamming attack
2. Present 3 countermeasure plans
3. Prompt for plan selection (type 1, 2, or 3)
4. Execute selected plan

### Gradio Web Interface

```bash
uv run python gradio_vulnerability_v1_app.py
```

Navigate to `http://localhost:7861`

**Workflow:**
1. Select predefined scenario or enter custom attack JSON
2. Click "Run Assessment"
3. Review 3 proposed plans in tabs
4. Click button to select and execute plan
5. View execution report

<!-- ### Custom Attack (Python API)

```python
from src.main import run_vulnerability_assessment
import json

attack = {
    "attack_type": "jamming",
    "timestamp": "2025-10-21T14:30:00Z",
    "sources": [{
        "source_id": "J-001",
        "location": {"lat": 36.5, "lon": -6.3},
        "frequency_mhz": 9400.0,
        "power_dbm": 75.0,
        "jamming_type": "barrage",
        "affected_systems": ["communications"]
    }],
    "network_anomalies": {
        "packet_loss": 45,
        "latency_increase": 300
    }
}

def plan_selector(plans):
    # Custom selection logic
    return plans[1]['plan_id']  # Select plan 2

result = run_vulnerability_assessment(
    attack_input=json.dumps(attack),
    hitl_callback=plan_selector
)
``` -->

---

## Sample Scenarios

Four predefined attack scenarios in `data/sample_attacks/`:

| Scenario | Description | Threat Level | Key Features |
|----------|-------------|--------------|--------------|
| **01: Single Barrage** | Wide-band noise jamming | High | 1 source, 45% packet loss |
| **02: Spot Critical** | Precision datalink jamming | Critical | Narrow-band, 85% packet loss |
| **03: Multi-Source** | Coordinated attack | Critical | 3 sources, multiple systems |
| **04: Follower** | Cognitive adaptive jammer | Critical | Tracks frequency changes |

---

## Countermeasure Strategies

The system can propose plans using these countermeasures:

**Electronic Warfare:**
- ECM (Electronic Counter Measures)
- Frequency Hopping
- Power Increase (Burn-through)
- EMCON (Emission Control)

**Kinetic:**
- UAV Neutralization
- Evasive Maneuvers

**Communications:**
- Alternative Channels (SATCOM, UHF, laser)
- Directional Antennas

---

## Technical Architecture

### Agents (5)

- **Cybersecurity Agent**: Network anomaly detection
- **Electronic Warfare Agent**: Jamming classification
- **Tactical Planning Agent**: Countermeasure plan generation
- **Evaluator Agent**: Plan validation via simulation
- **Actuator Agent**: Countermeasure execution

### Key Patterns

**Planner-Evaluator Loop:**
```
Tactical Agent â†’ Evaluator Agent
      â†‘                 â†“
      â””â”€â”€â”€ (if rejected) â”€â”€â”€â”˜
```

Iterates until 3 viable plans approved (effectiveness >40%, logically sound).

**Human-In-The-Loop:**
```
3 Approved Plans â†’ Human Selection â†’ Execution
```

Maintains human authority for combat decisions.

### Dependencies

- CrewAI: Multi-agent orchestration
- Pydantic v2: Data validation
- Gradio: Web interface
- UV: Dependency management
- Python stdlib logging

---

## Output Files

After assessment, reports generated in `output/`:

- `network_anomaly_detection_task.md`: Network analysis
- `jamming_classification_task.md`: Source classification
- `tactical_planning_task.md`: 3 proposed plans
- `plan_evaluation_task.md`: Simulation results
- `countermeasure_execution_task.md`: Execution report

---

## Related Projects

Naval Agentic AI Series:

1. **susceptibility-agent-v1**: Stealth and detection avoidance
2. **vulnerability-agent-v1**: Attack response (this project)
3. **[Project 3]**: TBD

All projects share common architecture and reusable components.

---

## Attack Data Format

```json
{
  "attack_type": "jamming",
  "timestamp": "2025-10-21T14:30:00Z",
  "sources": [
    {
      "source_id": "J-001",
      "location": {"lat": 36.5, "lon": -6.3},
      "frequency_mhz": 9400.0,
      "power_dbm": 75.0,
      "jamming_type": "barrage",
      "bandwidth_mhz": 200.0,
      "affected_systems": ["communications", "datalink"],
      "bearing_degrees": 45.0,
      "range_km": 28.5
    }
  ],
  "network_anomalies": {
    "packet_loss": 45,        # Percentage of data packets that fail to reach their destination.
    "latency_increase": 300,  # Increase in data transmission delay.
    "corrupted_frames": 120,  # Number of data frames that arrive with errors or are corrupted.
    "connection_drops": 3     # Number of times an active network connection is unexpectedly terminated.
  }
}
```

---

### Key Features

- âœ… **5 Specialized AI Agents**: Cybersecurity, EW, Tactical Planning, Evaluator, Actuator
- âœ… **Human-In-The-Loop (HITL)**: Commanding officer selects from 3 approved plans
- âœ… **Planner-Evaluator Loop**: Iterative plan refinement until viable
- âœ… **Jamming Database**: 7 jamming types with recommended countermeasures
- âœ… **Sensor Simulation**: ESM, ELINT, Radar, GNSS, Comms receivers
- âœ… **Dummy Actuators**: Placeholder tools for ECM, UAV, frequency hopping, etc.
- âœ… **Gradio Web Interface**: Interactive UI for testing scenarios
- âœ… **CLI Mode**: Command-line testing with sample attacks

---

## ğŸ¯ Use Case: Responding to Jamming Attack

**Scenario**: Hostile UAV launches barrage jamming attack on ship communications

### Workflow

```
1. Cybersecurity Agent
   â””â”€> Detects: 45% packet loss, 300ms latency increase
   
2. EW Agent
   â””â”€> Classifies: Barrage jamming at 9400 MHz from bearing 045Â°
   
3. Tactical Planning Agent âŸ· Evaluator Agent
   â””â”€> Proposes 3 plans â†’ Evaluator simulates â†’ Iterates until approved
   
4. HUMAN IN THE LOOP ğŸ‘¤
   â””â”€> Commanding officer selects Plan 2 (UAV Neutralization)
   
5. Actuator Agent
   â””â”€> Executes: Deploy UAV â†’ Evasive maneuver â†’ EMCON Bravo
   â””â”€> Result: Jamming source neutralized, comms restored
```

---

## ğŸ—ï¸ Architecture

### Agents (5)

| Agent | Role | Responsibilities |
|-------|------|-----------------|
| **Cybersecurity** | Network Analyst | Detect packet loss, latency, corrupted frames |
| **Electronic Warfare** | EW Specialist | Classify jamming sources, recommend countermeasures |
| **Tactical Planning** | Response Planner | Develop 3 distinct countermeasure plans |
| **Evaluator** | Plan Validator | Simulate plans, approve if >40% effective |
| **Actuator** | Execution Officer | Deploy countermeasures using ship systems |

### Tools (20+)

**Detection & Classification:**
- Network Anomaly Detector
- Jamming Classifier
- EW Signal Processor
- ESM/ELINT/GNSS/Comms Sensor Simulators

**Planning & Evaluation:**
- Countermeasure Simulator

**Execution (Dummy Actuators):**
- ECM Actuator
- Frequency Hop Actuator
- Power Increase Actuator
- UAV Actuator
- Evasive Maneuver Actuator
- EMCON Actuator
- Alternative Channel Actuator

### Countermeasure Strategies

**Electronic Warfare:**
- ECM (Electronic Counter Measures)
- Frequency Hopping
- Power Increase (Burn-through)
- EMCON (Emission Control)

**Kinetic/Physical:**
- UAV Neutralization
- Evasive Maneuvers
- Chaff/Decoys

**Communication:**
- Alternative Channels (SATCOM, laser, etc.)
- Directional Antennas

---

## ğŸš€ Quick Start

### Run Sample Attack

**CLI Mode:**
```bash
uv run python -m src.main
```

The system will:
1. Analyze a sample jamming attack
2. Present 3 countermeasure plans
3. Ask you to select a plan (type 1, 2, or 3)
4. Execute the selected plan

**Gradio Web Interface:**
```bash
uv run python gradio_vulnerability_v1_app.py
```

Open browser to `http://localhost:7860`

---

## ğŸ“ Project Structure

```
vulnerability-agent-v1/
â”œâ”€â”€ pyproject.toml              # UV dependencies
â”œâ”€â”€ README.md
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ agents.yaml             # 5 agent definitions
â”‚   â”œâ”€â”€ tasks.yaml              # 5 task definitions
â”‚   â””â”€â”€ jamming_database.json   # Jamming types & countermeasures
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ crew.py                 # Crew definition (@CrewBase)
â”‚   â”œâ”€â”€ main.py                 # Public API + CLI + HITL
â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”œâ”€â”€ multimodal_tools.py         # Sensor simulators (expanded)
â”‚   â”‚   â”œâ”€â”€ network_anomaly_detector.py
â”‚   â”‚   â”œâ”€â”€ jamming_classifier.py
â”‚   â”‚   â”œâ”€â”€ countermeasure_simulator.py
â”‚   â”‚   â””â”€â”€ actuator_tools.py           # 7 dummy actuators
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ attack_data.py      # Pydantic models
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ logger.py           # Python stdlib logging
â”œâ”€â”€ data/sample_attacks/        # 4 example scenarios (JSON)
â”‚   â”œâ”€â”€ scenario_01_single_barrage.json
â”‚   â”œâ”€â”€ scenario_02_spot_critical.json
â”‚   â”œâ”€â”€ scenario_03_multiple_sources.json
â”‚   â””â”€â”€ scenario_04_follower_jamming.json
â”œâ”€â”€ output/                     # Generated reports
â””â”€â”€ gradio_vulnerability_v1_app.py
```

---

## ğŸ® Usage Examples

### Example 1: CLI Test with Default Scenario

```bash
python -m src.main
```

Output:
```
========================================
HUMAN IN THE LOOP - SELECT COUNTERMEASURE PLAN
========================================

PLAN 1: Aggressive Electronic Countermeasures
  Effectiveness: 85%
  PROS: High effectiveness, Fast execution
  CONS: Increases EM signature

PLAN 2: UAV Kinetic Neutralization
  Effectiveness: 90%
  PROS: Eliminates threat permanently
  CONS: Slow execution, Expends UAV

PLAN 3: Defensive Evasion and EMCON
  Effectiveness: 70%
  PROS: Minimal resource expenditure
  CONS: Lower effectiveness

Enter plan number (1, 2, or 3): 2

âœ“ Executing UAV Neutralization...
âœ“ Mission complete - Jamming source eliminated
```

### Example 2: Gradio Interface

```bash
python gradio_vulnerability_v1_app.py
```

1. Select scenario from dropdown (or upload custom JSON)
2. Click "Run Assessment"
3. Review 3 proposed plans in tabs
4. Click button to select plan
5. View execution report

### Example 3: Custom Attack Scenario

```python
from src.main import run_vulnerability_assessment
import json

# Create custom attack
attack = {
    "attack_type": "jamming",
    "timestamp": "2025-10-21T14:30:00Z",
    "sources": [{
        "source_id": "J-999",
        "location": {"lat": 36.5, "lon": -6.3},
        "frequency_mhz": 9400.0,
        "power_dbm": 75.0,
        "jamming_type": "barrage",
        "affected_systems": ["communications"]
    }],
    "network_anomalies": {
        "packet_loss": 45,
        "latency_increase": 300
    }
}

# Run assessment with custom HITL callback
def my_plan_selector(plans):
    # Custom logic to select plan
    return plans[1]['plan_id']  # Select plan 2

result = run_vulnerability_assessment(
    attack_input=json.dumps(attack),
    hitl_callback=my_plan_selector
)

print(f"Selected: {result['selected_plan']}")
print(f"Success: {result['success']}")
```

---

## ğŸ“Š Sample Scenarios

### Scenario 1: Single Barrage Jamming
- **Threat**: Low-medium
- **Source**: 1 UAV at 28 km
- **Impact**: 45% packet loss
- **Best Response**: Frequency hopping + ECM

### Scenario 2: Spot Jamming on Datalink
- **Threat**: Critical
- **Source**: Precision jammer at 18 km
- **Impact**: 85% packet loss, fire control disrupted
- **Best Response**: UAV neutralization + alternative channels

### Scenario 3: Multi-Source Coordinated Attack
- **Threat**: Critical
- **Sources**: 3 jammers (barrage + deceptive + sweep)
- **Impact**: 70% packet loss, multiple systems affected
- **Best Response**: Combined ECM + UAV + EMCON

### Scenario 4: Intelligent Follower Jamming
- **Threat**: Critical
- **Source**: Cognitive jammer tracking frequency changes
- **Impact**: 92% packet loss, defeats standard countermeasures
- **Best Response**: EMCON + kinetic neutralization

---

## ğŸ”§ Configuration

### Jamming Database (`config/jamming_database.json`)

Defines 7 jamming types with recommended countermeasures:

- **Barrage**: Wide-band noise jamming
- **Spot**: Narrow-band targeting specific frequencies
- **Sweep**: Frequency-sweeping across bands
- **Deceptive**: False signal injection
- **Pulse**: High-power pulsed interference
- **Noise**: Random spectrum degradation
- **Follower**: Adaptive/cognitive jamming

Each type includes:
- Technical characteristics
- Threat level
- Recommended countermeasures ranked by effectiveness

### Environment Variables

Create `.env` file:

```bash
# LLM API Keys (choose one or both)
ANTHROPIC_API_KEY=sk-ant-...
OPENAI_API_KEY=sk-...

# Logging
LOG_LEVEL=INFO

# Optional: HuggingFace token for audio tools
HF_TOKEN=hf_...
```

---
![frontal_b](https://github.com/MartinezAgullo/naval-agentic-ai/blob/main/b_vulnerability-agent-v1/data/frontal_vulnerability_agent.svg)

---

**ğŸ›¡ï¸ Vulnerability Agent** - Protecting naval vessels through intelligent electronic warfare response.

*Part of the Naval Agentic AI Research Series*